describe('DmbVideoUploader Directive',()=>{let element=null;let loadFile=null;let container=null;const contentType='video/ogg';const vid1sec='T2dnUwACAAAAAAAAAAAN7tVeAAAAABTo2UUBKoB0aGVvcmEDAgEAHgAXAAHgAAFoAAgAAE8aAAAFKQAAAQAAAQAAAABIwE9nZ1MAAgAAAAAAAAAAOmDTSwAAAAD76xdUAR4Bdm9yYmlzAAAAAAJErAAAAAAAAIC1AQAAAAAAuAFPZ2dTAAAAAAAAAAAAAA3u1V4BAAAAL9w1aA6x element=document.createElement('dmb-video-uploader');container=document.querySelector('#components');element.setAttribute('preview',true);container.append(element);const dataURLtoFile=(b64Data,contentType='',sliceSize=512)=>{const byteCharacters=atob(b64Data);const byteArrays=[];let blob=null;let slice=null;let byteNumbers=null;let byteArray=null;for(let offset=0;offset<byteCharacters.length;offset+=sliceSize){slice=byteCharacters.slice(offset,offset+sliceSize);byteNumbers=new Array(slice.length);for(let i=0;i<slice.length;i++){byteNumbers[i]=slice.charCodeAt(i);}byteArray=new Uint8Array(byteNumbers);byteArrays.push(byteArray);}blob=new Blob(byteArrays,{type:contentType});return blob;};const imgFile=dataURLtoFile(vid1sec,contentType);let previewvideo=null;afterEach(done=>{element && element.remove();done();});beforeAll((done)=>{previewvideo=element.querySelector('.preview video');done();});it('Should render element',(done)=>{expect(element).toBeDefined();done();});loadFile=function(target){console.log(`trying to send data to ${target}`);};it('Should check if video was previewed',(done)=>{spyOn(element,'loadFile');element.querySelector('input[type="file"]').dispatchEvent(new Event('change'));expect(element.loadFile).toHaveBeenCalled();done();});it('Should load the image in content preview',(done)=>{previewvideo.src='';element.loadFile(imgFile).then(()=>{expect(previewvideo.getAttribute('src')).toBe(`data:video/ogg;base64,${vid1sec}`);done();});});});