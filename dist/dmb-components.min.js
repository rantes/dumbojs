class DmbInput extends DumboDirective{static get observedAttributes(){return["valid","name","validate","dmb-name"]}constructor(){super();const template="<label></label>"+'<input type="text" placeholder="" />'+'<span class="error-container"></span>';this.setTemplate(template);this.isValid=false;this._errorInputClass="_error";this.validations={_required:function(value){let response={valid:true,error:null};if(typeof value==="undefined"||value===null||value===""){response.valid=false;response.error="Este campo es obligatorio"}return response},_email:function(value){let response={valid:true,error:null},re=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/;if(value&&!re.test(value)){response.valid=false;response.error="No es una direcci&oacute;n de email v&aacute;lido"}return response},_numeric:function(value){let response={valid:true,error:null},re=/^[0-9]\d*/;if(value&&!re.test(value)){response.valid=false;response.error="Este campo debe ser solo num&eacute;rico"}return response},_min:function(value,param){let response={valid:true,error:null};if(value&&value.length<param){response.valid=false;response.error="Este campo debe ser de "+param+" caracteres m&iacute;nimo"}return response},_max:function(value,param){let response={valid:true,error:null};if(value&&value.length>param){response.valid=false;response.error="Este campo debe ser de "+param+" caracteres m&aacute;ximo"}return response}}}attributeChangedCallback(attr,oldValue,newValue){const input=this.querySelector("input");switch(attr){case"valid":this.isValid=newValue!==null;break;case"name":if(input)input.setAttribute("name",newValue);break;case"dmb-name":if(input)input.setAttribute("name",newValue);break}}buildValidators(){let validators=[];let validatorList=(this.getAttribute("validate")||"").split(",");let input=null;for(let i=0,len=validatorList.length;i<len;i++){let keyParam=validatorList[i].split(":");if(keyParam[0]){validators.push({key:keyParam[0],param:keyParam.length===2?keyParam[1]:null});if(keyParam[0]==="required"){input=this.querySelector("input");this.classList.add("required");input.setAttribute("required","required")}}}return validators}_runValidators(element,validators){const unknownValidator=()=>{return{valid:false,error:'Unknown validator type: "'+(validator||{}).key+'"'}};let content=element.value.trim();let valid=true;let validator=null;let func=null;let result=null;let message=null;element.value=content;for(let i=0,len=validators.length;i<len;i++){validator=validators[i];func=this.validations["_"+validator.key]||unknownValidator;result=func(content,validator.param);if(result.valid!==true){valid=false;message=result.error;break}}if(valid===true){element.parentNode.classList.remove(this._errorInputClass);element.parentNode.querySelectorAll(".error-container").item(0).innerHTML=""}else{element.parentNode.classList.add(this._errorInputClass);element.parentNode.querySelectorAll(".error-container").item(0).innerHTML=message}this.isValid=valid;valid?element.setAttribute("valid",""):element.removeAttribute("valid")}resetValidation(){let elements=this.getElementsByClassName(this._errorInputClass);for(let i=0;elements.length;i++){elements.item(0).classList.remove(this._errorInputClass)}}setValidation(){this._runValidators(this.querySelector("input"),this.buildValidators())}init(){const input=this.querySelector("input");const label=this.getAttribute("label")||null;const masked=this.getAttribute("masked")||null;const autocomplete=this.getAttribute("autocomplete")||null;const classd=this.getAttribute("dmb-class")||null;const name=this.getAttribute("dmb-name")||null;const validate=this.getAttribute("validate")||null;const pattern=this.getAttribute("pattern")||null;const value=this.getAttribute("value")||null;if(label){this.querySelector("label").innerText=label;input.setAttribute("aria-label",label);input.setAttribute("placeholder",label)}if(masked)input.setAttribute("masked",masked);if(autocomplete)input.setAttribute("autocomplete",autocomplete);if(classd)input.setAttribute("class",classd);if(name)input.setAttribute("name",name);if(validate)input.setAttribute("validate",validate);if(pattern)input.setAttribute("pattern",pattern);if(value)input.value=value;input.id=this.getAttribute("dmb-id")||this.generateId();input.setAttribute("valid","true");input.setAttribute("type",this.getAttribute("type")||"text");const maskInputUppercase=e=>{e.target.value=e.target.value.toUpperCase()};const maskInputAlpha=e=>{var char=e.which||e.keyCode;if((char<65||char>90)&&(char<97||char>122)){return false}};const maskInputNumeric=e=>{var char=e.which||e.keyCode;if(char<48||char>57){return false}};if(this.getAttribute("masked")){switch(this.getAttribute("masked")){case"alpha":input.onkeypress=maskInputAlpha;break;case"numeric":input.onkeypress=maskInputNumeric;break;case"uppercase":input.oninput=maskInputUppercase;break}}input.addEventListener("blur",()=>{this.setValidation()},true)}}customElements.define("dmb-input",DmbInput);class DmbClosePanel extends DumboDirective{constructor(){super();const template='<i class="icon"></i>';this.setTemplate(template)}init(){const orientation=this.getAttribute("orientation")||"right";const icon=this.querySelector("i.icon");let panel=null;this.classList.add(orientation);icon.classList.add(`icon-chevron-${orientation}`);this.addEventListener("click",()=>{panel=this.closest("dmb-panel");panel.close()})}}customElements.define("dmb-close-panel",DmbClosePanel);class DmbMenuButton extends DumboDirective{constructor(){super();let template='<i class="icon icon-bars"></i>'+'<span class="legend"></span>';this.setTemplate(template)}init(){const legend=this.getAttribute("legend");this.querySelector(".legend").textContent=legend;this.addEventListener("click",()=>{let menu=this.getAttribute("menu");if(menu.length){document.querySelector(menu).showModal()}})}}customElements.define("dmb-menu-button",DmbMenuButton);class DmbWysiwyg extends DumboDirective{static get observedAttributes(){return["valid","name","validate","dmb-name"]}constructor(){super();const template='<section class="dmb-wysiwyg" >'+'<div class="dmb-wysiwyg__toolbar">'+'<a href="#" title="Heading 2" class="dmb-wysiwyg__toolbar-button" data-command="h2">H2</a>'+'<a href="#" title="Heading 3" class="dmb-wysiwyg__toolbar-button" data-command="h3">H3</a>'+'<a href="#" title="Heading 4" class="dmb-wysiwyg__toolbar-button" data-command="h4">H4</a>'+'<a href="#" title="Heading 5" class="dmb-wysiwyg__toolbar-button" data-command="h5">H5</a>'+'<a href="#" title="Heading 6" class="dmb-wysiwyg__toolbar-button" data-command="h6">H6</a>'+'<a href="#" title="Undo" class="icon icon-undo dmb-wysiwyg__toolbar-button" data-command="undo"></a>'+'<a href="#" title="Redo" class="icon icon-redo dmb-wysiwyg__toolbar-button" data-command="redo"></a>'+'<a href="#" title="Paragraph" class="icon icon-pilcrow dmb-wysiwyg__toolbar-button" data-command="p"></a>'+'<a href="#" title="Link" class="icon icon-link dmb-wysiwyg__toolbar-button" data-command="createlink"></a>'+'<a href="#" title="Left Align" class="icon icon-paragraph-left dmb-wysiwyg__toolbar-button" data-command="justifyLeft"></a>'+'<a href="#" title="Center Align" class="icon icon-paragraph-center dmb-wysiwyg__toolbar-button" data-command="justifyCenter"></a>'+'<a href="#" title="Justify Align" class="icon icon-paragraph-justify dmb-wysiwyg__toolbar-button" data-command="justifyFull"></a>'+'<a href="#" title="right Align" class="icon icon-paragraph-right dmb-wysiwyg__toolbar-button" data-command="justifyRight"></a>'+'<a href="#" title="Super" class="icon icon-superscript2 dmb-wysiwyg__toolbar-button" data-command="superscript"></a>'+'<div title="Font Color" class="dmb-wysiwyg__toolbar-button palette">'+'<i class="icon icon-brush"></i>'+'<div class="fore-palette"></div>'+"</div>"+'<div title="Background Color" class="dmb-wysiwyg__toolbar-button back-palette">'+'<i class="icon icon-palette"></i>'+'<div class="fore-palette"></div>'+"</div>"+'<a href="#" title="View Source" class="dmb-wysiwyg__toolbar-button source-button" data-command="source" style="width: 4em;">Source</a>'+'<a href="#" title="View compiled" class="dmb-wysiwyg__toolbar-button normal-button" data-command="normal" style="display:none;">Normal</a>'+"</div>"+'<textarea class="dmb-wysiwyg__content-content novalidate"></textarea>'+'<section class="dmb-wysiwyg__content-content novalidate" contenteditable transclude>'+"</section>"+'<span class="error-container"></span>'+"</section>";this.setTemplate(template);this.isValid=false;this._errorWysiwygClass="v_error";this.colorPalette=["000000","FF9966","6699FF","99FF66","CC0000","00CC00","0000CC","333333","0066FF","FFFFFF"];this.toolbarElements=[];this.validations={_required:function(value){let response={valid:true,error:null};if(typeof value==="undefined"||value===null||value===""){response.valid=false;response.error="Este campo es obligatorio"}return response}}}init(){const forePalette=this.querySelector(".palette .fore-palette");const backPalette=this.querySelector(".back-palette .fore-palette");let hideButtons=null;let showButtons=null;let executeCommand=null;let a=document.createElement("a");let ap=document.createElement("a");let textArea=this.querySelector("textarea.dmb-wysiwyg__content-content");this.toolbarElements=this.querySelectorAll(".dmb-wysiwyg__toolbar-button");a.dataset.command="foreColor";ap.dataset.command="backColor";a.setAttribute("href","#");ap.setAttribute("href","#");a.classList.add("palette-item");ap.classList.add("palette-item");a.classList.add("dmb-wysiwyg__toolbar-button");ap.classList.add("dmb-wysiwyg__toolbar-button");for(let i=0;i<this.colorPalette.length;i++){a.dataset.value=`${this.colorPalette[i]}`;ap.dataset.value=`${this.colorPalette[i]}`;a.style.backgroundColor=`#${this.colorPalette[i]}`;ap.style.backgroundColor=`#${this.colorPalette[i]}`;forePalette.append(a.cloneNode(true));backPalette.append(ap.cloneNode(true))}textArea.setAttribute("hidden",true);textArea.value=this.querySelector("textArea.dmb-wysiwyg__content-content").innerHTML;textArea.setAttribute("name",this.getAttribute("dmb-name")||"");textArea.setAttribute("validate",this.getAttribute("validate")||"");textArea.setAttribute("valid","true");hideButtons=(toolbarElements=>{for(let j=0;j<toolbarElements.length;j++){toolbarElements[j].style.display="none"}});showButtons=(toolbarElements=>{for(let j=0;j<toolbarElements.length;j++){toolbarElements[j].style.display="flex"}});executeCommand=(e=>{const me=e.target;let command=me.dataset.command;let value=me.dataset.value;let url;let textArea;let editArea;e.stopImmediatePropagation();e.stopPropagation();e.preventDefault();switch(command){case"h2":case"h3":case"h4":case"h5":case"h6":case"p":document.execCommand("formatBlock",true,command);break;case"foreColor":case"backColor":document.execCommand(command,true,value);break;case"createlink":case"insertimage":url=prompt("Enter the link here: ","");if(url&&url.length){document.execCommand(command,false,url)}break;case"source":hideButtons(this.toolbarElements);me.parentNode.querySelector(".normal-button").style.display="flex";textArea=me.parentNode.parentNode.querySelector("textarea.dmb-wysiwyg__content-content");editArea=me.parentNode.parentNode.querySelector("section.dmb-wysiwyg__content-content");textArea.value=editArea.innerHTML;textArea.setAttribute("hidden",false);textArea.removeAttribute("hidden");editArea.setAttribute("hidden",true);break;case"normal":showButtons(this.toolbarElements);me.style.display="none";textArea=me.parentNode.parentNode.querySelector("textarea.dmb-wysiwyg__content-content");editArea=me.parentNode.parentNode.querySelector("section.dmb-wysiwyg__content-content");editArea.innerHTML=textArea.value;editArea.setAttribute("hidden",false);editArea.removeAttribute("hidden");textArea.setAttribute("hidden",true);break;default:document.execCommand(command,false,null);break}});for(let i=0;i<this.toolbarElements.length;i++){this.toolbarElements[i].addEventListener("click",executeCommand)}if(this.getAttribute("validate")&&this.getAttribute("validate").length){this.setValidation()}}buildValidators(){let validators=[];let validatorList=(this.getAttribute("validate")||"").split(",");let textarea=null;let editArea=null;for(let i=0,len=validatorList.length;i<len;i++){let keyParam=validatorList[i].split(":");if(keyParam[0]){validators.push({key:keyParam[0],param:keyParam.length===2?keyParam[1]:null});if(keyParam[0]==="required"){textarea=this.querySelector("textarea");this.classList.add("required");textarea.setAttribute("required","required")}if(keyParam[0]==="required"){editArea=this.querySelector("section");this.classList.add("required");editArea.setAttribute("required","required")}}}return validators}_runValidators(element,validators){const unknownValidator=()=>{return{valid:false,error:'Unknown validator type: "'+(validator||{}).key+'"'}};let content=(element.value||element.innerHTML).trim();let valid=true;let validator=null;let func=null;let result=null;let message=null;for(let i=0,len=validators.length;i<len;i++){validator=validators[i];func=this.validations["_"+validator.key]||unknownValidator;result=func(content,validator.param);if(result.valid!==true){valid=false;message=result.error;break}}if(valid===true){element.parentNode.classList.remove(this._errorWysiwygClass);element.parentNode.querySelectorAll(".error-container").item(0).innerHTML=""}else{element.parentNode.classList.add(this._errorWysiwygClass);element.parentNode.querySelectorAll(".error-container").item(0).innerHTML=message}this.isValid=valid;valid?element.setAttribute("valid",""):element.removeAttribute("valid")}setValidation(){let validators=[];const textarea=this.querySelector("textarea.dmb-wysiwyg__content-content");const editarea=this.querySelector("section.dmb-wysiwyg__content-content");validators=this.buildValidators();textarea.addEventListener("blur",()=>{this._runValidators(textarea,validators)},true);editarea.addEventListener("blur",()=>{this._runValidators(editarea,validators)},true);document.body.addEventListener(window.dmbEventsService.validate.listener,()=>{this._runValidators(textarea,validators);this._runValidators(editarea,validators)},true);document.body.addEventListener(window.dmbEventsService.resetValidation.listener,()=>{let elements=this.getElementsByClassName(this._errorWysiwygClass);for(let i=0;elements.length;i++){elements.item(0).classList.remove(this._errorWysiwygClass)}},true)}syncData(){let textArea=this.querySelector("textarea.dmb-wysiwyg__content-content");let editArea=this.querySelector("section.dmb-wysiwyg__content-content");if(textArea.hasAttribute("hidden")){textArea.value=editArea.innerHTML}else{editArea.innerHTML=textArea.value}}attributeChangedCallback(attr,oldValue,newValue){const textarea=this.querySelector("textarea.dmb-wysiwyg__content-content");const editarea=this.querySelector("section.dmb-wysiwyg__content-content");switch(attr){case"valid":this.isValid=newValue!==null;break;case"name":if(textarea)textarea.setAttribute("name",newValue);break;case"dmb-name":if(textarea)textarea.setAttribute("name",newValue);break;case"validate":if(textarea){textarea.setAttribute("validate",newValue);if(newValue&&newValue.length){this.setValidation()}}if(editarea){editarea.setAttribute("validate",newValue);if(newValue&&newValue.length){this.setValidation()}}break}}}customElements.define("dmb-wysiwyg",DmbWysiwyg);class DmbFooter extends DumboDirective{constructor(){super()}init(){this.classList.add("dmb-footer");this.closest(".dmb-view").classList.add("padded-footer")}}customElements.define("dmb-footer",DmbFooter);class DmbForm extends DumboDirective{constructor(){super();this.valids=0}submit(){const hasValids=(items,parentSelector)=>{let item=null;let parent=null;let hasInvalids=false;while(item=items.pop()){if(item.closest(".novalidate")===null){parent=item.closest(parentSelector);parent.resetValidation();parent.setValidation();if(!item.hasAttribute("valid")&&!item.hasAttribute("hidden")){item.reportValidity();item.focus();hasInvalids=true}else{this.valids++}}}return!hasInvalids};const inputs=[...this.querySelectorAll("dmb-input input[validate]")];const selects=[...this.querySelectorAll("dmb-select select[validate]")];const textAreas=[...this.querySelectorAll("dmb-text-area textarea[validate]")];const isAsync=this.hasAttribute("async");let totalvalidations=0;let vForm=null;let allInputs=null;let allSelects=null;let allTextareas=null;let element=null;let newElement=null;this.valids=0;totalvalidations=hasValids(inputs,"dmb-input")+hasValids(selects,"dmb-select")+hasValids(textAreas,"dmb-text-area");if(totalvalidations===3){this.dispatchEvent(new Event("onsubmit"));if(isAsync){if(typeof this.callback==="function"){this.callback()}}else{vForm=document.createElement("form");vForm.method=this.getAttribute("method");vForm.action=this.getAttribute("action");vForm.name=this.getAttribute("dmb-name");vForm.enctype=this.getAttribute("enctype");vForm.style="visibility: hidden; height: 0; width: 0;";allInputs=[...this.querySelectorAll("input")];allSelects=[...this.querySelectorAll("select")];allTextareas=[...this.querySelectorAll("textarea")];while(element=allInputs.shift()){newElement=element.cloneNode(true);if(element.type==="file"){newElement.files=element.files}else{newElement.value=element.value}vForm.appendChild(newElement)}while(element=allSelects.shift()){newElement=element.cloneNode(true);newElement.value=element.value;vForm.appendChild(newElement)}while(element=allTextareas.shift()){newElement=element.cloneNode(true);newElement.value=element.value;vForm.appendChild(newElement)}document.body.appendChild(vForm);this.getAttribute("action")&&vForm.submit()}return true}return false}getFormData(){const formObject=new FormData;[].forEach.call(this.querySelectorAll("input"),input=>{let name=input.getAttribute("name");if(input.type==="file"){for(let i=0;i<input.files.length;i++){formObject.append(`${name}[]`,input.files[i],input.files[i])}}else{formObject.append(name,input.value)}});[].forEach.call(this.querySelectorAll("select"),select=>{formObject.append(select.getAttribute("name"),select.value)});[].forEach.call(this.querySelectorAll("textarea"),textarea=>{formObject.append(textarea.getAttribute("name"),textarea.value)});return formObject}}customElements.define("dmb-form",DmbForm);class DmbTextArea extends DumboDirective{static get observedAttributes(){return["valid","name","validate","dmb-name"]}constructor(){super();const template="<label></label>"+"<textarea transclude>"+"</textarea>"+'<span class="error-container"></span>';this.setTemplate(template);this.isValid=false;this.validators=[];this._errorInputClass="_error";this.validations={_required:function(value){let response={valid:true,error:null};if(typeof value==="undefined"||value===null||value===""){response.valid=false;response.error="Este campo es obligatorio"}return response},_numeric:function(value){let response={valid:true,error:null},re=/^[0-9]\d*/;if(value&&!re.test(value)){response.valid=false;response.error="Este campo debe ser solo num&eacute;rico"}return response},_min:function(value,param){let response={valid:true,error:null};if(value&&value.length<param){response.valid=false;response.error="Este campo debe ser de "+param+" caracteres m&iacute;nimo"}return response},_max:function(value,param){let response={valid:true,error:null};if(value&&value.length>param){response.valid=false;response.error="Este campo debe ser de "+param+" caracteres m&aacute;ximo"}return response}}}attributeChangedCallback(attr,oldValue,newValue){const input=this.querySelector("textarea");switch(attr){case"valid":this.isValid=newValue!==null;break;case"name":if(input)input.setAttribute("name",newValue);break;case"dmb-name":if(input)input.setAttribute("name",newValue);break;case"validate":if(input)input.setAttribute("validate",newValue);break}}init(){let input=this.getElementsByTagName("textarea").item(0);this.querySelector("label").innerText=this.getAttribute("label");input.setAttribute("aria-label",this.getAttribute("label")||"");input.setAttribute("masked",this.getAttribute("masked")||"");input.setAttribute("autocomplete",this.getAttribute("autocomplete")||"");input.setAttribute("class",this.getAttribute("dmb-class")||"");input.setAttribute("name",this.getAttribute("dmb-name")||"");input.setAttribute("validate",this.getAttribute("validate")||"");input.setAttribute("placeholder",this.getAttribute("placeholder")||"");input.setAttribute("valid","true");input.id=this.getAttribute("dmb-id")||this.generateId();const maskInputUppercase=e=>{e.target.value=e.target.value.toUpperCase()};if(input&&this.getAttribute("validate")){this.validators=this.buildValidators(input,this)}input.addEventListener("blur",e=>{this._runValidators(e.target,this.validators)},{capture:true,passive:true});const maskInputAlpha=e=>{var char=e.which||e.keyCode;if((char<65||char>90)&&(char<97||char>122)){return false}};const maskInputNumeric=e=>{var char=e.which||e.keyCode;if(char<48||char>57){return false}};if(this.getAttribute("validate")){this.validators=this.buildValidators(input,this);input.addEventListener("blur",e=>{this._runValidators(e.target,this.validators)},true)}if(this.getAttribute("masked")){switch(this.getAttribute("masked")){case"alpha":input.onkeypress=maskInputAlpha;break;case"numeric":input.onkeypress=maskInputNumeric;break;case"uppercase":input.oninput=maskInputUppercase;break}}}_runValidators(element,validators){var unknownValidator=()=>{return{valid:false,error:'Unknown validator type: "'+(validator||{}).key+'"'}},content=element.value.trim(),valid=true,validator=null,func=null,result=null,message=null;element.value=content;for(var i=0,len=validators.length;i<len;i++){validator=validators[i];func=this.validations["_"+validator.key]||unknownValidator;result=func(content,validator.param);if(result.valid!==true){valid=false;message=result.error;break}}if(valid===true){element.parentNode.classList.remove(this._errorInputClass);element.parentNode.querySelectorAll(".error-container").item(0).innerHTML=""}else{element.parentNode.classList.add(this._errorInputClass);element.parentNode.querySelectorAll(".error-container").item(0).innerHTML=message}this.isValid=valid;valid?element.setAttribute("valid",""):element.removeAttribute("valid")}buildValidators(element,scope){var validators=[],validatorList=(scope.getAttribute("validate")||"").split(",");for(var i=0,len=validatorList.length;i<len;i++){var keyParam=validatorList[i].split(":");if(keyParam[0]){validators.push({key:keyParam[0],param:keyParam.length===2?keyParam[1]:null});if(keyParam[0]==="required"){element.parentNode.classList.add("required");element.setAttribute("required","required")}}}return validators}resetValidation(){let elements=this.getElementsByClassName(this._errorInputClass);for(let i=0;elements.length;i++){elements.item(0).classList.remove(this._errorInputClass)}}setValidation(){this._runValidators(this.querySelector("textarea"),this.validators)}}customElements.define("dmb-text-area",DmbTextArea);class DmbPageLoader extends DumboDirective{constructor(){super();window.addEventListener("beforeunload",()=>{this.classList.add("active")});document.addEventListener("readystatechange",()=>setTimeout(()=>{document.readyState==="complete"&&this.classList.contains("active")&&this.close()},100));document.addEventListener("DOMContentLoaded",()=>setTimeout(()=>{this.classList.contains("active")&&this.close()},100));window.addEventListener(window.dmbEventsService.pageLoaderClose.listener,()=>this.close())}close(){this.classList.remove("active");return true}}customElements.define("dmb-page-loader",DmbPageLoader);class DmbButton extends DumboDirective{constructor(){super()}_submitter(){const form=this.closest("dmb-form");const type=this.getAttribute("type");if(type==="submit"&&form){form.submit()}}init(){this.addEventListener("click",this._submitter)}click(method){if(typeof method==="function"){this.removeEventListener("click",this._submitter);this.addEventListener("click",method)}}}customElements.define("dmb-button",DmbButton);class DmbInfoPop extends DumboDirective{constructor(){super();const template='<div class="float-content" transclude></div>';this.setTemplate(template)}init(){const size=this.getAttribute("size")||"small";this.querySelector(".float-content").classList.add(`float-content_${size}`)}}customElements.define("dmb-info-pop",DmbInfoPop);class DmbImageloader extends DumboDirective{constructor(){super();const template='<input id="img-uploader" type="file" name="preload" accept="image/*"/>'+'<div class="preview"><img alt="Image Preview"></div>';this.setTemplate(template)}init(){let imgloader=this.querySelector('input[type="file"]');imgloader.addEventListener("change",e=>{this.loadFile(e.target.files[0])})}loadFile(file){let previewimg=this.querySelector(".preview img");let reader=new FileReader;reader.onload=(()=>{previewimg.setAttribute("src",reader.result.toString())});reader.readAsDataURL(file)}}customElements.define("dmb-imageloader",DmbImageloader);class DmbHeader extends DumboDirective{constructor(){super()}init(){let titleDOM=null;if(this.title){titleDOM=document.createElement("h2");titleDOM.classList.add("dmb-header-title");titleDOM.textContent=this.title;this.prepend(titleDOM)}}}customElements.define("dmb-header",DmbHeader);class DmbPanel extends DumboDirective{static get observedAttributes(){return["source"]}constructor(){super();const template='<section class="dmb-view wrapper" transclude>'+"</section>";this.setTemplate(template);this.returnValue=null}attributeChangedCallback(attr,oldValue,newValue){!!newValue&&newValue.length&&this.loadExternalSource()}loadExternalSource(){const url=this.getAttribute("source");let wrapper=null;let sourceRequest=null;if(url&&url.length){sourceRequest=new Request(url);fetch(sourceRequest).then(res=>res.text()).then(data=>{wrapper=this.querySelector(".wrapper");wrapper.innerHTML=data})}return true}close(value){this.returnValue=value;this.removeAttribute("open");this.dispatchEvent(new Event("close"));this.localName==="dmb-dialog"&&this.remove();this.dispatchEvent(new Event("close-dialog"))}open(){this.setAttribute("open","");this.dispatchEvent(new Event("open"));this.addEventListener("click",e=>{if(this.openValue&&e.target===this){this.close("cancelled")}},true)}showModal(){const buttons=this.querySelectorAll('[type="modal-answer"]');[].forEach.call(buttons,button=>{button.addEventListener("click",e=>{this.close(e.target.getAttribute("value"))})});this.open()}setCloseButton(){let icon=null;if(!this.classList.contains("loader")){icon=document.createElement("i");icon.classList.add("icon");icon.classList.add("icon-cancel");icon.classList.add("close-modal-button");icon.addEventListener("click",e=>{e.target.closest("dmb-dialog").close("cancelled")});this.querySelector(".wrapper").prepend(icon)}}isOpen(){return this.openValue}setIcon(icon){const iconElement=document.createElement("i");const wrapper=this.querySelector(".wrapper");iconElement.classList.add("icon");iconElement.classList.add(`icon-${icon}`);wrapper.prepend(iconElement)}error(msg){const message=document.createElement("span");const wrapper=this.querySelector(".wrapper");this.setCloseButton();this.setIcon("alert");msg=msg||"";this.classList.add("error");message.classList.add("message");message.textContent=msg;wrapper.append(message)}prompt(options){const message=document.createElement("span");const wrapper=this.querySelector(".wrapper");let msg=options.message||"";this.classList.add("question");message.classList.add("message");message.textContent=msg;wrapper.append(message)}onClose(fn){if(typeof fn==="function"){this.addEventListener("close-panel",fn)}}init(){!this.classList.contains("right")&&!this.classList.contains("left")&&this.classList.add("right");!this.classList.contains("small")&&!this.classList.contains("large")&&this.classList.add("small");this.addEventListener("click",e=>{e.target===this&&this.close("cancelled")},true);this.loadExternalSource()}}customElements.define("dmb-panel",DmbPanel);class DmbSelect extends DumboDirective{static get observedAttributes(){return["valid","values","dmb-name"]}constructor(){super();const template="<label></label>"+"<select transclude></select>"+'<span class="error-container"></span>';this.setTemplate(template);this.validations={_required:value=>{let response={valid:true,error:null};if(typeof value==="undefined"||value===null||value===""){response.valid=false;response.error="Este campo es obligatorio"}return response}};this.isValid=false;this.values=[];this.validators=[];this._errorInputClass="_error"}init(){let select=this.querySelector("select");this.querySelector("label").innerText=this.getAttribute("label");select.setAttribute("aria-label",this.getAttribute("label")||"");select.setAttribute("class",this.getAttribute("dmb-class")||"");select.setAttribute("name",this.getAttribute("dmb-name")||"");select.setAttribute("valid","true");select.setAttribute("validate",this.getAttribute("validate"));select.id=this.getAttribute("dmb-id")||this.generateId();select.value=this.getAttribute("value");if(select&&this.getAttribute("validate")){this.validators=this.buildValidators(select,this.getAttribute("validate"))}select.addEventListener("blur",e=>{this._runValidators(e.target,this.validators)},{capture:true,passive:true})}_runValidators(element,validators){let unknownValidator=()=>{return{valid:false,error:'Unknown validator type: "'+(validator||{}).key+'"'}},content=(element.value||"").trim(),valid=true,validator=null,func=null,result=null,message=null;element.value=content;for(var i=0,len=validators.length;i<len;i++){validator=validators[i];func=this.validations["_"+validator.key]||unknownValidator;result=func(content,validator.param);if(result.valid!==true){valid=false;message=result.error;break}}if(valid===true){element.parentNode.classList.remove(this._errorInputClass);element.parentNode.querySelectorAll(".error-container").item(0).innerHTML=""}else{element.parentNode.classList.add(this._errorInputClass);element.parentNode.querySelectorAll(".error-container").item(0).innerHTML=message}this.isValid=valid;valid?element.setAttribute("valid",true):element.removeAttribute("valid")}buildValidators(element,validations){let validators=[];let validatorList=(validations||"").split(",");let keyParam="";for(let i=0,len=validatorList.length;i<len;i++){keyParam=validatorList[i].split(":");if(keyParam[0]){validators.push({key:keyParam[0],param:keyParam.length===2?keyParam[1]:null});if(keyParam[0]==="required"){element.parentNode.classList.add("required");element.setAttribute("required",true)}}}return validators}attributeChangedCallback(attr,oldValue,newValue){let select=this.querySelector("select");switch(attr){case"valid":this.isValid=newValue!==null;break;case"values":if(!oldValue&&newValue){this.buildOptions();this.querySelector("select").dispatchEvent(new Event("change"))}break;case"dmb-name":if(select)this.querySelector("select").setAttribute("name",newValue);break}}buildOptions(){let i=0;let total=this.values.length||0;let option=null;const select=this.querySelector("select");select.innerHTML="";select.value="";for(i=0;i<total;i++){option=document.createElement("option");option.setAttribute("value",this.values[i].value);option.innerHTML=this.values[i].text;if(this.values[i].selected||this.values[i]===select.value){option.setAttribute("selected",true);select.value=this.values[i].value}select.append(option)}this.removeAttribute("values")}resetValidation(){let elements=this.getElementsByClassName(this._errorInputClass);for(let i=0;elements.length;i++){elements.item(0).classList.remove(this._errorInputClass)}}setValidation(){this._runValidators(this.querySelector("select"),this.validators)}}customElements.define("dmb-select",DmbSelect);class DmbDialog extends DumboDirective{static get observedAttributes(){return["open"]}constructor(){super();const template='<section class="dmb-view wrapper" transclude>'+"</section>";this.setTemplate(template);this.returnValue=null}attributeChangedCallback(attr,oldValue,newValue){this.openValue=newValue!==null}close(value){this.returnValue=value;this.removeAttribute("open");this.dispatchEvent(new Event("close"));this.localName==="dmb-dialog"&&this.remove();this.dispatchEvent(new Event("close-dialog"))}open(){this.setAttribute("open","");this.dispatchEvent(new Event("open"));this.addEventListener("click",e=>{if(this.openValue&&e.target===this){this.close("cancelled")}},true)}showModal(){const buttons=this.querySelectorAll('[type="modal-answer"]');[].forEach.call(buttons,button=>{button.addEventListener("click",e=>{this.close(e.target.getAttribute("value"))})});this.open()}setCloseButton(){let icon=null;if(!this.classList.contains("loader")){icon=document.createElement("i");icon.classList.add("icon");icon.classList.add("icon-cancel");icon.classList.add("close-modal-button");icon.addEventListener("click",e=>{e.target.closest("dmb-dialog").close("cancelled")});this.querySelector(".wrapper").prepend(icon)}}isOpen(){return this.openValue}setIcon(icon){const iconElement=document.createElement("i");const wrapper=this.querySelector(".wrapper");iconElement.classList.add("icon");iconElement.classList.add(`icon-${icon}`);wrapper.prepend(iconElement)}error(msg){const message=document.createElement("span");const wrapper=this.querySelector(".wrapper");this.setCloseButton();this.setIcon("alert");msg=msg||"";this.classList.add("error");message.classList.add("message");message.textContent=msg;wrapper.append(message)}info(msg){const message=document.createElement("span");const wrapper=this.querySelector(".wrapper");this.setCloseButton();this.setIcon("info");msg=msg||"";this.classList.add("info");message.classList.add("message");message.textContent=msg;wrapper.append(message)}prompt(options){const message=document.createElement("span");const wrapper=this.querySelector(".wrapper");let msg=options.message||"";this.classList.add("question");message.classList.add("message");message.textContent=msg;wrapper.append(message)}onClose(fn){if(typeof fn==="function"){this.addEventListener("close-dialog",fn)}}}customElements.define("dmb-dialog",DmbDialog);